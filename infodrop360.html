<!DOCTYPE html>
<html lang="fr" class="dark">

<!-- ============================================================================ -->
<!-- üìã HEAD - M√âTADONN√âES ET CONFIGURATION                                      -->
<!-- ============================================================================ -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- === OPEN GRAPH ET R√âSEAUX SOCIAUX === -->
    <meta property="og:title" content="INFODROP 360¬∞ - Analyses multi-perspectives" />
    <meta property="og:description"
        content="Analyses approfondies de l'actualit√© avec toutes les perspectives m√©diatiques." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://infodrop.live/infodrop360.html" />
    <meta property="og:image" content="https://infodrop.live/images/infodrop-share.png" />

    <!-- === TWITTER CARD === -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="INFODROP 360¬∞ - Analyses multi-perspectives">
    <meta name="twitter:description"
        content="Analyses approfondies de l'actualit√© avec toutes les perspectives m√©diatiques.">
    <meta name="twitter:image" content="https://infodrop.live/images/infodrop-share.png">

    <title>INFODROP 360¬∞ - Analyses multi-perspectives</title>

    <!-- === FAVICON ET IC√îNES MOBILES HD === -->
    <link rel="icon" type="image/png" href="images/infodrop-favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="images/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/apple-touch-icon-120x120.png">
    <link rel="icon" type="image/png" sizes="192x192" href="images/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="images/android-chrome-512x512.png">

    <!-- Meta tags PWA -->
    <meta name="theme-color" content="#111827">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="INFODROP 360¬∞">

    <!-- === AM√âLIORATION PWA === -->
    <meta name="apple-itunes-app" content="app-id=com.infodrop.app">
    <link rel="alternate" href="app://infodrop.live">
    <meta name="format-detection" content="telephone=no">

    <!-- === URL SCHEME PERSONNALIS√â === -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- === BIBLIOTH√àQUES EXTERNES === -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <!-- ======================================================================== -->
    <!-- üé® STYLES CSS PERSONNALIS√âS                                             -->
    <!-- ======================================================================== -->
    <style>
        /* === ANIMATIONS ET TRANSITIONS PRINCIPALES === */
        .topic-card {
            background: linear-gradient(145deg, #1e293b, #334155);
            border-radius: 16px;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid #334155;
        }

        .topic-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border-color: #4f46e5;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* === SCROLLBAR PERSONNALIS√âE === */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #111827;
        }

        ::-webkit-scrollbar-thumb {
            background: #4b5563;
        }

        /* === ANIMATION DU BANDEAU D√âFILANT (MOBILE) === */
        .ticker-train {
            display: inline-flex;
            animation: scroll-left 20s linear infinite;
        }

        @keyframes scroll-left {
            from {
                transform: translateX(0%);
            }

            to {
                transform: translateX(-50%);
            }
        }

        .ticker-train:hover {
            animation-play-state: paused;
        }
    </style>

    <!-- === CONFIGURATION TAILWIND === -->
    <script>
        tailwind.config = { darkMode: 'class', theme: { extend: {} } }
    </script>
</head>

<body class="bg-gray-900 text-gray-300 min-h-screen font-sans">

    <!-- ======================================================================== -->
    <!-- üîê CONFIGURATION S√âCURIS√âE ET INITIALISATION SUPABASE                  -->
    <!-- ======================================================================== -->
    <script>
        // === VARIABLES GLOBALES (SANS VALEURS PAR D√âFAUT) ===
        let supabase = null;
        let STRIPE_LINK = 'https://buy.stripe.com/7sYcN6fh6ez47u5ejh28801';

        // === FONCTION D'INITIALISATION S√âCURIS√âE ===
        async function initializeSupabase() {
            try {
                console.log('üîê R√©cup√©ration de la configuration s√©curis√©e...');

                // R√©cup√©rer TOUTE la configuration depuis l'API s√©curis√©e
                const response = await fetch('/api/config');

                if (!response.ok) {
                    throw new Error(`Erreur API: ${response.status}`);
                }

                const config = await response.json();

                // V√©rifier que toutes les donn√©es sont pr√©sentes
                if (!config.supabaseUrl || !config.supabaseAnonKey) {
                    throw new Error('Configuration Supabase incompl√®te');
                }

                // Initialiser Supabase avec les cl√©s r√©cup√©r√©es
                supabase = window.supabase.createClient(config.supabaseUrl, config.supabaseAnonKey);

                // Mettre √† jour TOUTES les constantes s√©curis√©es
                STRIPE_LINK = config.stripeLink || '';

                console.log('‚úÖ Configuration compl√®te initialis√©e de mani√®re s√©curis√©e');
                console.log('üí≥ Stripe link r√©cup√©r√©: ‚úì');

                return true;

            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);

                // Affichage d'erreur utilisateur plus informatif
                const errorDiv = document.createElement('div');
                errorDiv.innerHTML = `
                    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: white; display: flex; align-items: center; justify-content: center; z-index: 9999; font-family: Arial;">
                        <div style="text-align: center; padding: 2rem;">
                            <h2>‚ùå Erreur de configuration</h2>
                            <p>Impossible de charger la configuration s√©curis√©e.</p>
                            <p>Veuillez contacter l'administrateur.</p>
                            <button onclick="window.location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #3B82F6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                Recharger la page
                            </button>
                        </div>
                    </div>
                `;
                document.body.appendChild(errorDiv);

                return false;
            }
        }
    </script>

    <!-- ======================================================================== -->
    <!-- üèóÔ∏è STRUCTURE PRINCIPALE DE L'APPLICATION                               -->
    <!-- ======================================================================== -->
    <div x-data="infodropApp()" x-init="init()" class="w-full">

        <!-- ================================================================== -->
        <!-- ‚è≥ √âCRAN DE CHARGEMENT                                            -->
        <!-- ================================================================== -->
        <div x-show="!sessionLoaded" class="min-h-screen flex items-center justify-center bg-gray-900">
            <div class="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
        </div>

        <!-- ================================================================== -->
        <!-- üîë PAGE DE CONNEXION                                              -->
        <!-- ================================================================== -->
        <div x-show="sessionLoaded && !user" x-transition
            class="min-h-screen flex items-center justify-center p-4 bg-gray-900">
            <div
                class="max-w-sm w-full bg-gray-800/50 backdrop-blur-sm rounded-lg shadow-2xl p-8 border border-gray-700">
                <h1 class="text-3xl font-bold text-center text-white mb-2">üì∞ INFODROP</h1>
                <p class="text-gray-400 text-center mb-8">Le Club priv√© de l'actu centralis√©e</p>

                <!-- === FORMULAIRE DE CONNEXION === -->
                <form @submit.prevent="login()" class="space-y-4">
                    <div>
                        <input x-model="email" type="email" required @input="email = email.toLowerCase()"
                            class="w-full px-4 py-2 bg-gray-900 border border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent placeholder-gray-500 text-white"
                            placeholder="votre@email.com">
                    </div>
                    <!-- === CHAMP CODE D'INVITATION === -->
                    <div>
                        <input x-model="inviteCode" type="text"
                            class="w-full px-4 py-2 bg-gray-900 border border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent placeholder-gray-500 text-white"
                            placeholder="Code d'invitation (si nouveau)">
                    </div>
                    <button type="submit" :disabled="loading"
                        class="w-full bg-indigo-600 text-white py-3 rounded-lg font-medium hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <span x-show="!loading">Recevoir le lien magique</span>
                        <span x-show="loading">Envoi en cours...</span>
                    </button>
                </form>

                <!-- === LIEN D'AIDE === -->
                <p class="text-xs text-center text-gray-500 mt-4">
                    üí° Pas de code ? Suivez <a href="https://x.com/LOR4_14" target="_blank"
                        class="text-blue-400 hover:underline">nos annonces</a> pour en gagner un !
                </p>

                <!-- === MESSAGES DE RETOUR === -->
                <div x-show="message" class="mt-4 p-3 rounded-lg text-sm"
                    :class="messageType === 'error' ? 'bg-red-900/50 text-red-300 border border-red-700' : 'bg-green-900/50 text-green-300 border border-green-700'"
                    x-text="message"></div>
            </div>
        </div>

        <!-- ================================================================== -->
        <!-- üè† APPLICATION PRINCIPALE (UTILISATEUR CONNECT√â)                  -->
        <!-- ================================================================== -->
        <div x-show="sessionLoaded && user" x-transition.opacity class="min-h-screen flex flex-col">

            <!-- ============================================================== -->
            <!-- üì± HEADER UNIFI√â AVEC NAVIGATION ET BANDEAUX                -->
            <!-- ============================================================== -->
            <div class="sticky top-0 z-40 transition-shadow duration-300" id="stickyHeader">

                <!-- === HEADER PRINCIPAL === -->
                <header class="relative z-50 bg-gray-900/95 backdrop-blur-sm border-b border-gray-800">
                    <div class="max-w-4xl mx-auto px-4 py-3 grid grid-cols-3 items-center">
                        <!-- === LOGO === -->
                        <div class="justify-self-start">
                            <a href="/index.html"
                                class="flex items-center gap-2 text-xl font-bold text-white hover:text-blue-400 transition whitespace-nowrap"
                                style="line-height:1;">
                                <span class="text-lg md:text-xl"
                                    style="display:inline-block;vertical-align:middle;">üì∞</span>
                                <span class="tracking-tight"
                                    style="display:inline-block;vertical-align:middle;">INFODROP</span>
                                <span class="text-blue-400 font-bold"
                                    style="display:inline-block;vertical-align:middle;margin-left:0.2em;">360¬∞</span>
                                <!-- === VERSION TAG === -->
                                <span
                                    class="ml-2 text-xs font-medium text-gray-400 bg-slate-700 px-2 py-0.5 rounded-full">3.0.0-beta</span>
                            </a>
                        </div>

                        <div class="justify-self-center"></div>

                        <!-- === MENU HAMBURGER === -->
                        <div class="justify-self-end relative" x-data="{ showMenu: false }">
                            <button @click="showMenu = !showMenu" class="p-2 rounded-full hover:bg-gray-700 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                    fill="currentColor">
                                    <path fill-rule="evenodd"
                                        d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                        clip-rule="evenodd" />
                                </svg>
                            </button>

                            <!-- === DROPDOWN MENU === -->
                            <div x-show="showMenu" @click.away="showMenu = false" x-transition
                                class="absolute top-full right-0 mt-2 w-52 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-[100]"
                                style="display: none;">

                                <!-- === FLUX PRINCIPAL === -->
                                <div class="px-4 py-2 border-b border-gray-700">
                                    <a href="/index.html"
                                        class="flex items-center gap-3 text-base font-semibold text-blue-300 hover:text-white transition">üì∞
                                        Le Flux 24h</a>
                                </div>

                                <!-- === ITEMS DE MENU === -->
                                <a href="/apropos.html"
                                    class="flex items-center gap-3 px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">‚ÑπÔ∏è
                                    √Ä propos</a>
                                <a :href="STRIPE_LINK" target="_blank"
                                    class="flex items-center gap-3 px-4 py-2 text-sm text-red-400 hover:bg-gray-700">‚ù§Ô∏è
                                    Soutenir</a>

                                <!-- === D√âCONNEXION === -->
                                <div class="border-t border-gray-700 my-1"></div>
                                <a @click="logout()" href="#"
                                    class="flex items-center gap-3 px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">üö™
                                    D√©connexion</a>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- ========================================================== -->
                <!-- üì∞ BANDEAU CONTEXTUEL (DATE, M√âT√âO, PHASE LUNAIRE...)    -->
                <!-- ========================================================== -->
                <div x-data="contextTicker()" x-init="initTicker()" class="bg-gray-800/95 border-b border-gray-700 h-8">

                    <!-- === VERSION MOBILE (D√©filante) === -->
                    <div class="md:hidden h-full overflow-hidden relative">
                        <div class="ticker-train absolute flex items-center h-full" style="width: max-content;">
                            <!-- === COPIE 1 === -->
                            <div class="flex items-center gap-8 text-sm text-gray-300 whitespace-nowrap px-4">
                                <span class="flex items-center gap-1">
                                    <span class="text-yellow-400">üìÖ</span>
                                    <span x-text="dateInfo.fullDate"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span class="text-blue-400">üìä</span>
                                    Jour <span class="font-semibold text-white" x-text="dateInfo.dayOfYear"></span>/365
                                </span>
                                <span x-show="todayFeast" class="flex items-center gap-1">
                                    <span class="text-red-400">üéâ</span>
                                    <span class="font-semibold text-white" x-text="todayFeast"></span>
                                </span>
                                <span x-show="weather.temperature !== null" class="flex items-center gap-1">
                                    <span x-text="weather.icon"></span>
                                    <span class="font-semibold text-white"><span
                                            x-text="weather.temperature"></span>¬∞C</span>
                                    <span class="text-gray-400" x-text="weather.description"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span x-text="moonPhase.icon"></span>
                                    <span x-text="moonPhase.name"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span class="text-green-400">‚è≥</span>
                                    <span class="font-semibold text-white" x-text="dateInfo.daysUntilNewYear"></span>
                                    jours avant 2026
                                </span>
                                <span class="text-gray-600 mx-4">‚Ä¢</span>
                            </div>

                            <!-- === COPIE 2 (IDENTIQUE POUR L'ANIMATION) === -->
                            <div class="flex items-center gap-8 text-sm text-gray-300 whitespace-nowrap px-4">
                                <span class="flex items-center gap-1">
                                    <span class="text-yellow-400">üìÖ</span>
                                    <span x-text="dateInfo.fullDate"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span class="text-blue-400">üìä</span>
                                    Jour <span class="font-semibold text-white" x-text="dateInfo.dayOfYear"></span>/365
                                </span>
                                <span x-show="todayFeast" class="flex items-center gap-1">
                                    <span class="text-red-400">üéâ</span>
                                    <span class="font-semibold text-white" x-text="todayFeast"></span>
                                </span>
                                <span x-show="weather.temperature !== null" class="flex items-center gap-1">
                                    <span x-text="weather.icon"></span>
                                    <span class="font-semibold text-white"><span
                                            x-text="weather.temperature"></span>¬∞C</span>
                                    <span class="text-gray-400" x-text="weather.description"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span x-text="moonPhase.icon"></span>
                                    <span x-text="moonPhase.name"></span>
                                </span>
                                <span class="flex items-center gap-1">
                                    <span class="text-green-400">‚è≥</span>
                                    <span class="font-semibold text-white" x-text="dateInfo.daysUntilNewYear"></span>
                                    jours avant 2026
                                </span>
                                <span class="text-gray-600 mx-4">‚Ä¢</span>
                            </div>
                        </div>
                    </div>

                    <!-- === VERSION DESKTOP (Statique) === -->
                    <div class="hidden md:flex items-center justify-center h-full">
                        <div class="flex items-center gap-8 text-sm text-gray-300 whitespace-nowrap px-4">
                            <span class="flex items-center gap-1">
                                <span class="text-yellow-400">üìÖ</span>
                                <span x-text="dateInfo.fullDate"></span>
                            </span>
                            <span class="flex items-center gap-1">
                                <span class="text-blue-400">üìä</span>
                                Jour <span class="font-semibold text-white" x-text="dateInfo.dayOfYear"></span>/365
                            </span>
                            <span x-show="todayFeast" class="flex items-center gap-1">
                                <span class="text-red-400">üéâ</span>
                                <span class="font-semibold text-white" x-text="todayFeast"></span>
                            </span>
                            <span x-show="weather.temperature !== null" class="flex items-center gap-1">
                                <span x-text="weather.icon"></span>
                                <span class="font-semibold text-white"><span
                                        x-text="weather.temperature"></span>¬∞C</span>
                                <span class="text-gray-400" x-text="weather.description"></span>
                            </span>
                            <span class="flex items-center gap-1">
                                <span x-text="moonPhase.icon"></span>
                                <span x-text="moonPhase.name"></span>
                            </span>
                            <span class="flex items-center gap-1">
                                <span class="text-green-400">‚è≥</span>
                                <span class="font-semibold text-white" x-text="dateInfo.daysUntilNewYear"></span> jours
                                avant 2026
                            </span>
                        </div>
                    </div>
                </div>

                <!-- ========================================================== -->
                <!-- üë§ BARRE UTILISATEUR (PARRAINAGE SEULEMENT)               -->
                <!-- ========================================================== -->
                <div x-show="userInviteData.code || userInviteData.parrainEmail || userInviteData.filleulEmail" 
                     x-transition class="bg-gray-800/95 border-b border-gray-700 px-4 py-3 flex items-center">
                    <div class="max-w-4xl mx-auto w-full">

                        <!-- === CARTE PARRAINAGE PLIABLE === -->
                        <div x-data="{ showParrainage: false }" class="bg-gray-800/50 border border-gray-700 rounded-lg my-1">

                            <!-- Header pliable avec code CENTR√â -->
                            <button @click="showParrainage = !showParrainage" class="w-full py-1.5 px-3">
                                <div class="flex items-center justify-center relative">
                                    <!-- Code √† partager CENTR√â -->
                                    <div x-show="userInviteData.code" class="flex items-center gap-2">
                                        <span class="text-yellow-400 text-xs">üéÅ</span>
                                        <span class="text-gray-300 text-xs">Code √† partager :</span>
                                        <span
                                            class="font-mono bg-gray-900 px-1.5 py-0.5 rounded cursor-pointer hover:bg-gray-700 transition text-white text-xs border border-gray-600"
                                            @click.stop="copyInviteMessage(userInviteData.code)"
                                            title="Cliquez pour copier" x-text="userInviteData.code">
                                        </span>
                                        <span x-show="copied"
                                            class="text-green-400 font-semibold transition bg-green-900/20 px-1.5 py-0.5 rounded text-xs">Copi√©
                                            !</span>
                                    </div>

                                    <!-- Placeholder si pas de code -->
                                    <div x-show="!userInviteData.code" class="text-xs text-gray-400">
                                        üë• Infos parrainage
                                    </div>

                                    <!-- Ic√¥ne d√©pliage (position absolue √† droite) -->
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                        class="h-3 w-3 transition-transform text-gray-400 absolute right-0"
                                        :class="{ 'rotate-180': showParrainage }" viewBox="0 0 20 20"
                                        fill="currentColor">
                                        <path fill-rule="evenodd"
                                            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </button>

                            <!-- Contenu d√©pliable - Relations -->
                            <div x-show="showParrainage" x-transition
                                x-show="userInviteData.parrainEmail || userInviteData.filleulEmail"
                                class="px-3 pb-2 space-y-2 text-center border-t border-gray-700 pt-2">

                                <!-- Parrain -->
                                <div x-show="userInviteData.parrainEmail"
                                    class="flex items-center justify-center gap-2 text-xs">
                                    <span class="text-green-400">üëÜ</span>
                                    <span class="text-gray-400">Invit√© par :</span>
                                    <span class="font-mono text-white" x-text="userInviteData.parrainEmail"></span>
                                </div>

                                <!-- Filleul -->
                                <div x-show="userInviteData.filleulEmail"
                                    class="flex items-center justify-center gap-2 text-xs">
                                    <span class="text-purple-400">üëá</span>
                                    <span class="text-gray-400">Votre filleul :</span>
                                    <span class="font-mono text-white" x-text="userInviteData.filleulEmail"></span>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

            <!-- ============================================================== -->
            <!-- üìä CONTENU PRINCIPAL - PAGE 360¬∞                             -->
            <!-- ============================================================== -->
            <main class="max-w-4xl mx-auto px-4 py-8 flex-grow w-full">
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-white mb-2">üåç Analyses 360¬∞</h1>
                    <p class="text-gray-400">Perspectives multi-sources sur les sujets d'actualit√©</p>
                </div>

                <!-- === LISTE DES ANALYSES === -->
                <div class="space-y-4">

                    <!-- SUJET 1 : Crise de l'eau √† Mayotte -->
                    <a href="/analyses/DEMO-crise-eau-mayotte.html" class="block topic-card p-6 fade-in">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex-grow">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-sm text-blue-400 font-semibold">Crise Sociale</span>
                                    <span class="text-xs bg-yellow-600 text-yellow-100 px-2 py-0.5 rounded-full">D√âMO</span>
                                </div>
                                <h3 class="text-lg font-medium text-white mb-2">
                                    Crise de l'eau √† Mayotte : la R√©publique oubli√©e ?
                                </h3>
                                <p class="text-sm text-gray-400 leading-relaxed">
                                    Analyse des diff√©rentes perspectives m√©diatiques sur la crise de l'eau qui frappe
                                    Mayotte depuis plusieurs mois.
                                </p>
                            </div>
                            <div
                                class="mt-4 sm:mt-0 sm:ml-6 text-sm text-gray-400 text-left sm:text-right leading-snug flex-shrink-0">
                                <div class="font-medium">29 juin 2025</div>
                                <div>6 sources analys√©es</div>
                                <div class="text-blue-400 mt-1">‚Üí Lire l'analyse</div>
                            </div>
                        </div>
                    </a>

                    <!-- SUJET 2 : R√©forme de l'audiovisuel public -->
                    <a href="/analyses/reforme-audiovisuel-public.html" class="block topic-card p-6 fade-in">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex-grow">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-sm text-red-400 font-semibold">Politique & M√©dias</span>
                                    <span class="text-xs bg-gray-600 text-gray-300 px-2 py-0.5 rounded-full">EN COURS</span>
                                </div>
                                <h3 class="text-lg font-medium text-white mb-2">
                                    R√©forme de l'audiovisuel public : la cr√©ation controvers√©e de "France M√©dias"
                                </h3>
                                <p class="text-sm text-gray-400 leading-relaxed">
                                    D√©cryptage des positions politiques et m√©diatiques sur la restructuration de
                                    l'audiovisuel public fran√ßais.
                                </p>
                            </div>
                            <div
                                class="mt-4 sm:mt-0 sm:ml-6 text-sm text-gray-400 text-left sm:text-right leading-snug flex-shrink-0">
                                <div class="font-medium">30 juin 2025</div>
                                <div>6 sources analys√©es</div>
                                <div class="text-gray-500 mt-1">En cours de finalisation</div>
                            </div>
                        </div>
                    </a>

                    <!-- MESSAGE D'INFO -->
                    <div class="bg-blue-900/20 border border-blue-700/30 rounded-lg p-6 text-center">
                        <div class="text-blue-400 text-lg mb-2">üöÄ</div>
                        <h3 class="text-white font-semibold mb-2">Plus d'analyses bient√¥t disponibles</h3>
                        <p class="text-gray-400 text-sm">
                            Nous travaillons sur de nouvelles analyses multi-perspectives pour vous offrir une vision
                            compl√®te de l'actualit√©.
                        </p>
                    </div>

                </div>
            </main>

            <!-- ============================================================== -->
            <!-- ü¶∂ FOOTER                                                     -->
            <!-- ============================================================== -->
            <footer class="text-center py-8 text-xs text-gray-500">
                <p>¬© 2025 INFODROP. Tous droits r√©serv√©s.</p>
                <p class="mt-1">Un projet 3C - EM&LPy</p>
            </footer>
        </div>

        <!-- ======================================================================== -->
        <!-- üîù BOUTON SCROLL TO TOP                                                 -->
        <!-- ======================================================================== -->
        <button x-data="{ show: false }" x-show="show" x-transition
            @click="window.scrollTo({ top: 0, behavior: 'smooth' })"
            x-init="window.addEventListener('scroll', () => { show = window.scrollY > 500 })"
            class="fixed bottom-6 right-6 z-40 bg-gray-800 hover:bg-gray-700 text-white p-3 rounded-full shadow-lg transition-all hover:scale-110 border border-gray-700"
            style="display: none;">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"
                    clip-rule="evenodd" />
            </svg>
        </button>
    </div>

    <!-- ======================================================================== -->
    <!-- üßÆ JAVASCRIPT - LOGIQUE M√âTIER ALL√âG√âE POUR 360¬∞                        -->
    <!-- ======================================================================== -->
    <script>
        // ====================================================================
        // üìÖ FONCTION BANDEAU CONTEXTUEL (DATE, M√âT√âO, LUNE...)
        // ====================================================================
        function contextTicker() {
            return {
                // === DONN√âES DE BASE ===
                dateInfo: {
                    fullDate: '',
                    dayOfYear: 0,
                    daysUntilNewYear: 0
                },
                todayFeast: '',
                weather: {
                    temperature: null,
                    description: '',
                    icon: 'üå°Ô∏è'
                },
                moonPhase: {
                    name: '',
                    icon: 'üåô'
                },

                // === DICTIONNAIRE DES F√äTES ===
                feasts: {
                    '01-01': 'Jour de l\'an',
                    '01-06': '√âpiphanie',
                    '02-02': 'Chandeleur',
                    '02-14': 'Saint-Valentin',
                    '03-17': 'Saint-Patrick',
                    '04-01': 'Poisson d\'avril',
                    '05-01': 'F√™te du travail',
                    '05-08': 'Victoire 1945',
                    '06-21': 'F√™te de la musique',
                    '07-14': 'F√™te nationale',
                    '08-15': 'Assomption',
                    '10-31': 'Halloween',
                    '11-01': 'Toussaint',
                    '11-11': 'Armistice 1918',
                    '12-25': 'No√´l',
                    '12-31': 'Saint-Sylvestre'
                },

                // === INITIALISATION DU TICKER ===
                async initTicker() {
                    this.updateDateInfo();
                    this.updateMoonPhase();
                    await this.getWeather();

                    const now = new Date();
                    const tomorrow = new Date(now);
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    tomorrow.setHours(0, 0, 0, 0);
                    const msUntilMidnight = tomorrow - now;

                    setTimeout(() => {
                        this.updateDateInfo();
                        this.updateMoonPhase();
                        setInterval(() => {
                            this.updateDateInfo();
                            this.updateMoonPhase();
                        }, 86400000);
                    }, msUntilMidnight);

                    setInterval(() => this.getWeather(), 600000);
                },

                // === MISE √Ä JOUR DES INFORMATIONS DE DATE ===
                updateDateInfo() {
                    const now = new Date();
                    const options = { weekday: 'long', day: 'numeric', month: 'long' };
                    this.dateInfo.fullDate = now.toLocaleDateString('fr-FR', options);
                    this.dateInfo.fullDate = this.dateInfo.fullDate.charAt(0).toUpperCase() + this.dateInfo.fullDate.slice(1);

                    const start = new Date(now.getFullYear(), 0, 0);
                    const diff = now - start;
                    this.dateInfo.dayOfYear = Math.floor(diff / (1000 * 60 * 60 * 24));

                    const nextYear = new Date(now.getFullYear() + 1, 0, 1);
                    this.dateInfo.daysUntilNewYear = Math.ceil((nextYear - now) / (1000 * 60 * 60 * 24));

                    const monthDay = `${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
                    this.todayFeast = this.feasts[monthDay] || '';
                },

                // === CALCUL DE LA PHASE LUNAIRE ===
                updateMoonPhase() {
                    const now = new Date();
                    const refNewMoon = new Date(2000, 0, 6);
                    const lunarCycle = 29.53058867;

                    const daysSinceRef = (now - refNewMoon) / (1000 * 60 * 60 * 24);
                    const moonAge = daysSinceRef % lunarCycle;

                    if (moonAge < 1.84566) {
                        this.moonPhase.name = 'Nouvelle lune';
                        this.moonPhase.icon = 'üåë';
                    } else if (moonAge < 5.53699) {
                        this.moonPhase.name = 'Premier croissant';
                        this.moonPhase.icon = 'üåí';
                    } else if (moonAge < 9.22831) {
                        this.moonPhase.name = 'Premier quartier';
                        this.moonPhase.icon = 'üåì';
                    } else if (moonAge < 12.91963) {
                        this.moonPhase.name = 'Gibbeuse croissante';
                        this.moonPhase.icon = 'üåî';
                    } else if (moonAge < 16.61096) {
                        this.moonPhase.name = 'Pleine lune';
                        this.moonPhase.icon = 'üåï';
                    } else if (moonAge < 20.30228) {
                        this.moonPhase.name = 'Gibbeuse d√©croissante';
                        this.moonPhase.icon = 'üåñ';
                    } else if (moonAge < 23.99361) {
                        this.moonPhase.name = 'Dernier quartier';
                        this.moonPhase.icon = 'üåó';
                    } else {
                        this.moonPhase.name = 'Dernier croissant';
                        this.moonPhase.icon = 'üåò';
                    }
                },

                // === R√âCUP√âRATION DES DONN√âES M√âT√âO ===
                async getWeather() {
                    try {
                        const position = await new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(resolve, reject, { timeout: 5000 });
                        });

                        const { latitude, longitude } = position.coords;

                        const response = await fetch(
                            `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&timezone=auto`
                        )

                        const data = await response.json();
                        const current = data.current_weather;

                        this.weather.temperature = Math.round(current.temperature);

                        const weatherCode = current.weathercode;
                        if (weatherCode === 0) {
                            this.weather.description = 'Ciel d√©gag√©';
                            this.weather.icon = '‚òÄÔ∏è';
                        } else if (weatherCode <= 3) {
                            this.weather.description = 'Partiellement nuageux';
                            this.weather.icon = '‚õÖ';
                        } else if (weatherCode <= 48) {
                            this.weather.description = 'Nuageux';
                            this.weather.icon = '‚òÅÔ∏è';
                        } else if (weatherCode <= 67) {
                            this.weather.description = 'Pluie';
                            this.weather.icon = 'üåßÔ∏è';
                        } else if (weatherCode <= 77) {
                            this.weather.description = 'Neige';
                            this.weather.icon = '‚ùÑÔ∏è';
                        } else if (weatherCode <= 99) {
                            this.weather.description = 'Orage';
                            this.weather.icon = '‚õàÔ∏è';
                        }

                    } catch (error) {
                        try {
                            const response = await fetch(
                                'https://api.open-meteo.com/v1/forecast?latitude=48.8566&longitude=2.3522&current_weather=true&timezone=Europe/Paris'
                            );
                            const data = await response.json();
                            const current = data.current_weather;

                            this.weather.temperature = Math.round(current.temperature);

                            const weatherCode = current.weathercode;
                            if (weatherCode === 0) {
                                this.weather.icon = '‚òÄÔ∏è';
                            } else if (weatherCode <= 3) {
                                this.weather.icon = '‚õÖ';
                            } else if (weatherCode <= 48) {
                                this.weather.icon = '‚òÅÔ∏è';
                            } else if (weatherCode <= 67) {
                                this.weather.icon = 'üåßÔ∏è';
                            } else if (weatherCode <= 77) {
                                this.weather.icon = '‚ùÑÔ∏è';
                            } else {
                                this.weather.icon = '‚õàÔ∏è';
                            }

                            this.weather.description = 'Paris';
                        } catch (err) {
                            console.error('Erreur m√©t√©o:', err);
                        }
                    }
                }
            };
        }

        // ====================================================================
        // üèóÔ∏è APPLICATION PRINCIPALE - VERSION ALL√âG√âE POUR PAGE 360¬∞
        // ====================================================================
        function infodropApp() {
            return {
                // ============================================================
                // üìä √âTAT MINIMAL DE L'APPLICATION
                // ============================================================

                // === INTERFACE UTILISATEUR ===
                copied: false,
                sessionLoaded: false,
                user: null,
                email: '',
                loading: false,
                message: '',
                messageType: '',
                inviteCode: '',

                // === SYST√àME D'INVITATIONS (LECTURE SEULE) ===
                userInviteData: {
                    code: null,
                    is_used: false,
                    parrainEmail: null,
                    filleulEmail: null
                },

                // ============================================================
                // üöÄ INITIALISATION SIMPLIFI√âE
                // ============================================================
                async init() {
                    console.log('üöÄ Initialisation de la page 360¬∞...');
                    const supabaseReady = await initializeSupabase();
                    if (!supabaseReady) {
                        this.sessionLoaded = true;
                        return;
                    }

                    // === GESTION DES √âV√âNEMENTS D'AUTHENTIFICATION ===
                    supabase.auth.onAuthStateChange(async (event, session) => {
                        this.user = session?.user || null;
                        this.sessionLoaded = true;
                        if (event === 'SIGNED_IN') {
                            console.log('‚úÖ Utilisateur connect√© sur page 360¬∞');
                            this.loadUserInviteData();
                        }
                        if (event === 'SIGNED_OUT') {
                            this.userInviteData = {
                                code: null,
                                is_used: false,
                                parrainEmail: null,
                                filleulEmail: null
                            };
                        }
                    });

                    // === GESTION DE L'INTERFACE ===
                    window.addEventListener('scroll', () => {
                        document.getElementById('stickyHeader')?.classList.toggle('shadow-xl', window.scrollY > 10);
                    });
                },

                // ============================================================
                // üîê SYST√àME D'AUTHENTIFICATION SIMPLIFI√â
                // ============================================================

                // === PROCESSUS DE CONNEXION ===
                async login() {
                    if (this.loading) return;
                    this.loading = true;
                    this.message = '';
                    this.messageType = '';
                    try {
                        const checkRes = await fetch('/api/check-email', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email: this.email.toLowerCase() })
                        });
                        if (!checkRes.ok) {
                            const err = await checkRes.json();
                            throw new Error(err.error || 'Erreur de communication.');
                        }
                        const { exists } = await checkRes.json();

                        if (!exists) {
                            if (!this.inviteCode) {
                                this.message = "Code d'invitation requis pour les nouveaux utilisateurs.";
                                this.messageType = 'error';
                                this.loading = false;
                                return;
                            }
                            const validateRes = await fetch('/api/validate-invite', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ code: this.inviteCode, email: this.email })
                            });
                            const validationResult = await validateRes.json();
                            if (!validationResult.success) {
                                this.message = validationResult.error;
                                this.messageType = 'error';
                                this.loading = false;
                                return;
                            }
                        }

                        const { error: otpError } = await supabase.auth.signInWithOtp({
                            email: this.email.toLowerCase(),
                            options: { emailRedirectTo: window.location.origin }
                        });
                        if (otpError) throw otpError;

                        this.message = 'V√©rifiez vos emails ! Un lien de connexion a √©t√© envoy√©.';
                        this.messageType = 'success';
                    } catch (error) {
                        this.message = error.message || 'Une erreur est survenue.';
                        this.messageType = 'error';
                    } finally {
                        this.loading = false;
                    }
                },

                // === CHARGEMENT DES DONN√âES D'INVITATION (LECTURE SEULE) ===
                async loadUserInviteData() {
                    if (!this.user || !this.user.email) {
                        console.log('‚ùå Pas d\'utilisateur connect√© pour charger les donn√©es d\'invitation');
                        return;
                    }

                    try {
                        console.log('üîÑ Chargement des donn√©es d\'invitation pour:', this.user.email);

                        // R√©cup√©rer le code d'invitation du compte connect√©
                        const { data: ownCode, error: ownCodeError } = await supabase
                            .from('invitation_codes')
                            .select('*')
                            .ilike('owner_email', this.user.email.toLowerCase())
                            .maybeSingle();

                        if (ownCodeError && ownCodeError.code !== 'PGRST116') {
                            console.error('‚ùå Erreur r√©cup√©ration code proprio:', ownCodeError);
                        } else if (ownCode) {
                            console.log('‚úÖ Code proprio r√©cup√©r√©:', ownCode);
                            this.userInviteData.code = ownCode.code;
                            this.userInviteData.is_used = ownCode.is_used || false;

                            if (ownCode.is_used && ownCode.used_by_email) {
                                this.userInviteData.filleulEmail = ownCode.used_by_email;
                            }
                        }

                        // R√©cup√©rer le parrain (qui a invit√© cet utilisateur)
                        const { data: usedCode, error: usedCodeError } = await supabase
                            .from('invitation_codes')
                            .select('owner_email')
                            .ilike('used_by_email', this.user.email.toLowerCase())
                            .maybeSingle();

                        if (usedCodeError && usedCodeError.code !== 'PGRST116') {
                            console.error('‚ùå Erreur r√©cup√©ration parrain:', usedCodeError);
                        } else if (usedCode) {
                            console.log('‚úÖ Parrain r√©cup√©r√©:', usedCode);
                            this.userInviteData.parrainEmail = usedCode.owner_email;
                        }

                        console.log('‚úÖ Donn√©es d\'invitation finales:', this.userInviteData);

                    } catch (error) {
                        console.error("‚ùå Erreur g√©n√©rale lors du chargement des donn√©es d'invitation:", error);
                        this.userInviteData = {
                            code: null,
                            is_used: false,
                            parrainEmail: null,
                            filleulEmail: null
                        };
                    }
                },

                // ============================================================
                // üîß UTILITAIRES ESSENTIELS
                // ============================================================

                async logout() {
                    await supabase.auth.signOut();
                },

                copyInviteMessage(code) {
                    const message = `Vous avez √©t√© invit√© √† rejoindre le club priv√© INFODROP !
Acc√©dez √† l'actu essentielle sur : https://infodrop.live
Utilisez ce code lors de votre inscription : ${code}`;

                    navigator.clipboard.writeText(message);
                    this.copied = true;
                    setTimeout(() => this.copied = false, 1500);
                }
            };
        }
    </script>
</body>

</html>